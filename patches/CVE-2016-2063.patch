diff --git a/drivers/thermal/supply_lm_core.c b/drivers/thermal/supply_lm_core.c
index fc8e807..a4d137f 100644
--- a/drivers/thermal/supply_lm_core.c
+++ b/drivers/thermal/supply_lm_core.c
@@ -1,4 +1,4 @@
-/* Copyright (c) 2015, The Linux Foundation. All rights reserved.
+/* Copyright (c) 2015-2016, The Linux Foundation. All rights reserved.
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 and
@@ -303,6 +303,11 @@ static ssize_t supply_lm_input_write(struct file *fp,
 	enum corner_state gpu;
 	enum corner_state modem;
 
+	if (count > (MODE_MAX - 1)) {
+		pr_err("Invalid user input\n");
+		return -EINVAL;
+	}
+
 	if (copy_from_user(&buf, user_buffer, count))
 		return -EFAULT;
 
