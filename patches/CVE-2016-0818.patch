diff --git a/kernel/events/core.c b/kernel/events/core.c
index 7dd822b..868300d 100644
--- a/kernel/events/core.c
+++ b/kernel/events/core.c
@@ -6243,6 +6243,9 @@ SYSCALL_DEFINE5(perf_event_open,
 	if (err)
 		return err;
 
+	if (attr.constraint_duplicate || attr.__reserved_1)
+		return -EINVAL;
+
 	if (!attr.exclude_kernel) {
 		if (perf_paranoid_kernel() && !capable(CAP_SYS_ADMIN))
 			return -EACCES;
